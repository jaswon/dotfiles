#!/bin/sh

seg=10

dir=/sys/class/backlight/intel_backlight
cur=$(cat $dir/brightness)
max=$(cat $dir/max_brightness)

curf=$(( (cur+1)*seg/max ))

case $1 in
	+|-) newf=$(seq 1 $seg | grep ^$(( curf $1 1 ))$ ) ;;
esac

newf=${newf:-$curf}
new=$(( newf*max/seg ))

# sudoers:
# user ALL=NOPASSWD: /usr/bin/tee /sys/class/backlight/intel_backlight/brightness
echo $new | sudo tee $dir/brightness >/dev/null

icon=$(echo -e '\ue26e')

volbar=$(yes '-' | head -n$newf | tr -d "\n")
padbar=$(yes ' ' | head -n$(( seg - newf )) | tr -d "\n")

noti "[$icon$volbar$padbar ]"
